<mat-card>
  Cash: {{ account.cash | currency:'USD':'symbol':'.2-2' }}
  <span style="float: right"
    [class]="uiService.cssGainLoss(account.marketValue - account.investment)">
    Market Value: {{ account.marketValue | currency:'USD':'symbol':'.2-2' }} (
    {{
      100 * (account.marketValue - account.investment) / account.investment
      | number:'.2-2'
    }}% ) 
  </span>
</mat-card>

<table mat-table matSort width="100%"
  [dataSource]="dataSource" class="mat-elevation-z8">

  <ng-container matColumnDef="ticker">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Ticker</th>
    <td mat-cell *matCellDef="let row">
      <span *ngIf="row.ticker">
      <a [href]="uiService.hqQUrl(row.ticker)"
        target="_blank">
        {{row.ticker}}</a>
      | <a [href]="uiService.hqCUrl(row.ticker)"
        target="_blank">
        C</a>
      </span>
    </td>
  </ng-container>

  <ng-container matColumnDef="date">
    <th mat-header-cell *matHeaderCellDef>Date</th>
    <td class="td-date" mat-cell *matCellDef="let row">
      {{row.date | date: 'MM/dd/yyyy'}}
    </td>
  </ng-container>

  <ng-container matColumnDef="close">
    <th mat-header-cell *matHeaderCellDef> Price </th>
    <td [class]="uiService.cssGainLoss(row.cChange)"
      mat-cell *matCellDef="let row">
      {{row.close | currency:'USD':'symbol':'.2-2'}}
    </td>
  </ng-container>

  <ng-container matColumnDef="shares">
    <th mat-header-cell *matHeaderCellDef> Shares </th>
    <td class="alignR" mat-cell *matCellDef="let row">
      <a *ngIf="row.count"
        (click)="groupSelected(row[groupBy])"
        title="Show more ..."
        href="javascript:">(+{{row.count}})</a>
      {{row.shares}}
    </td>
  </ng-container>

  <ng-container matColumnDef="buyPrice">
    <th mat-header-cell *matHeaderCellDef> Buy Price </th>
    <td [class]="uiService.cssGainLoss(uiService.getGainLoss(row))"
      mat-cell *matCellDef="let row">
      {{row.buyPrice | currency:'USD':'symbol':'.2-2'}}
    </td>
  </ng-container>

  <ng-container matColumnDef="soldPrice">
    <th mat-header-cell *matHeaderCellDef> Sold Price </th>
    <td class="alignR"
      mat-cell *matCellDef="let row">
      {{row.soldPrice | currency:'USD':'symbol':'.2-2'}}
    </td>
  </ng-container>

  <ng-container matColumnDef="buyDate">
    <th mat-header-cell *matHeaderCellDef mat-sort-header> Date Bought </th>
    <td class="td-date" mat-cell *matCellDef="let row">
      {{row.buyDate | date: 'MM/dd/yyyy'}}
    </td>
  </ng-container>

  <ng-container matColumnDef="soldDate">
    <th mat-header-cell *matHeaderCellDef mat-sort-header> Date Sold </th>
    <td class="td-date" mat-cell *matCellDef="let row">
      {{row.soldDate | date: 'MM/dd/yyyy'}}
    </td>
  </ng-container>

  <ng-container matColumnDef="buyCost">
    <th mat-header-cell *matHeaderCellDef>Cost</th>
    <td class="alignR" mat-cell *matCellDef="let row">

      {{ row.shares * row.buyPrice | currency:'USD':'symbol':'.2-2'}}

    </td>
  </ng-container>

  <ng-container matColumnDef="gainLoss">
    <th mat-header-cell *matHeaderCellDef>Gain/Loss</th>
    <td [class]="uiService.cssGainLoss(uiService.getGainLoss(row))"
      mat-cell *matCellDef="let row">

      {{ row.shares * uiService.getGainLoss(row) | currency:'USD':'symbol':'.2-2'}}

    </td>
  </ng-container>

  <ng-container matColumnDef="gainLossP">
    <th mat-header-cell *matHeaderCellDef>Gain/Loss %</th>
    <td [class]="uiService.cssGainLoss(uiService.getGainLoss(row))"
      mat-cell *matCellDef="let row">

      {{100 * uiService.getGainLoss(row) / row.buyPrice | number:'.2-2'}}%

    </td>
  </ng-container>

  <ng-container matColumnDef="cChange">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>C %</th>
    <td [class]="uiService.cssGainLoss(row.cChange)" mat-cell *matCellDef="let row">
      {{100 * row.cChange | number:'.2-2'}}%
    </td>
  </ng-container>

  <ng-container matColumnDef="vChange">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>V %</th>
    <td [class]="uiService.cssGainLoss(row.vChange)" mat-cell *matCellDef="let row">
      {{100 * row.vChange | number:'.2-2'}}%
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>
